Booking Agent View for most recent 30 day commissions and number of tickets
'''
Create View booking_agent_view as
Select sum(price * .1) as commissions, count(ticket_id) as tickets, avg(commissions) as avg_commissions
from flight inner join
(Select *
From booking_agent natural join purchases natural join ticket) as T on flight.flight_num = T.flight_num
Where purchase_date > Date_Sub(curdate(), INTERVAL 30 DAY) and email = {input_email};
'''

#Booking Agent View for top 5 customers
#for 6 month by number
'''
Create View top_5_customer_by_number as
Select customer_email, count(ticket_id) as number_of_tickets
from flight inner join
(Select *
From booking_agent natural join purchases natural join ticket) as T on flight.flight_num = T.flight_num
Where purchase_date > Date_Sub(curdate(), INTERVAL 6 MONTH) and email = {input_email}
group by customer_email
LIMIT 5;
'''
# for 1 year commissions
'''
Create View top_5_customer_by_commission as
Select customer_email, sum(price * .1) as commissions
from flight inner join
(Select *
From booking_agent natural join purchases natural join ticket) as T on flight.flight_num = T.flight_num
Where purchase_date > Date_Sub(curdate(), INTERVAL 1 YEAR) and email = input(email)
group by customer_email
LIMIT 5;
'''


Check for booking agent( if a booking agent does not work for an airline, then they cannot purchase tickets)
Select email, count(airline_name)
from booking_agent_work_for
where email = {input_email}



Checking Available Flights
Create view available_flights as
select airline_name, airplane_id, departure_airport, departure_time, arrival_airport, arrival_time, price, status, T.flight_num, (seats-tickets_purchased) num_of_available_tickets
from  (Select * From airplane natural join flight) as S
inner join (select flight_num, count(ticket_id ) as tickets_purchased
FROM reservation_system.ticket
group by flight_num) as T on S.flight_num = T.flight_num

Customer Spending tracking
Select sum(price) as spending
from flight inner join
(Select *
From purchases natural join ticket) as T on flight.flight_num = T.flight_num
Where customer_email = {input_email}